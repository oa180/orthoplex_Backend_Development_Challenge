acaf6e02d1042631961ef42e07b4c1cc
// import { createToken } from '../modules/Authentication/jwt.js';
const {
  createToken
} = require('../modules/Authentication/jwt.mjs');
process.env.JWT_SECRET = 'jwt-secret';
process.env.JWT_EXPIRES_IN = '1h';
test('should return jsonwebtoken if payload provided', () => {
  const payload = {
    id: '1',
    handler: 'test123'
  };
  jwt.sign = jest.fn(() => 'jwt-token');
  const token = createToken(payload);
  expect(jwt.sign).toHaveBeenCalledWith(payload, 'jwt-secret', {
    expiresIn: '1h'
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjcmVhdGVUb2tlbiIsInJlcXVpcmUiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsIkpXVF9FWFBJUkVTX0lOIiwidGVzdCIsInBheWxvYWQiLCJpZCIsImhhbmRsZXIiLCJqd3QiLCJzaWduIiwiamVzdCIsImZuIiwidG9rZW4iLCJleHBlY3QiLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsImV4cGlyZXNJbiJdLCJzb3VyY2VzIjpbImp3dC50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB7IGNyZWF0ZVRva2VuIH0gZnJvbSAnLi4vbW9kdWxlcy9BdXRoZW50aWNhdGlvbi9qd3QuanMnO1xyXG5jb25zdCB7IGNyZWF0ZVRva2VuIH0gPSByZXF1aXJlKCcuLi9tb2R1bGVzL0F1dGhlbnRpY2F0aW9uL2p3dC5tanMnKTtcclxuXHJcbnByb2Nlc3MuZW52LkpXVF9TRUNSRVQgPSAnand0LXNlY3JldCc7XHJcbnByb2Nlc3MuZW52LkpXVF9FWFBJUkVTX0lOID0gJzFoJztcclxuXHJcbnRlc3QoJ3Nob3VsZCByZXR1cm4ganNvbndlYnRva2VuIGlmIHBheWxvYWQgcHJvdmlkZWQnLCAoKSA9PiB7XHJcbiAgY29uc3QgcGF5bG9hZCA9IHsgaWQ6ICcxJywgaGFuZGxlcjogJ3Rlc3QxMjMnIH07XHJcbiAgand0LnNpZ24gPSBqZXN0LmZuKCgpID0+ICdqd3QtdG9rZW4nKTtcclxuXHJcbiAgY29uc3QgdG9rZW4gPSBjcmVhdGVUb2tlbihwYXlsb2FkKTtcclxuXHJcbiAgZXhwZWN0KGp3dC5zaWduKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChwYXlsb2FkLCAnand0LXNlY3JldCcsIHtcclxuICAgIGV4cGlyZXNJbjogJzFoJyxcclxuICB9KTtcclxufSk7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQSxNQUFNO0VBQUVBO0FBQVksQ0FBQyxHQUFHQyxPQUFPLENBQUMsbUNBQW1DLENBQUM7QUFFcEVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEdBQUcsWUFBWTtBQUNyQ0YsT0FBTyxDQUFDQyxHQUFHLENBQUNFLGNBQWMsR0FBRyxJQUFJO0FBRWpDQyxJQUFJLENBQUMsZ0RBQWdELEVBQUUsTUFBTTtFQUMzRCxNQUFNQyxPQUFPLEdBQUc7SUFBRUMsRUFBRSxFQUFFLEdBQUc7SUFBRUMsT0FBTyxFQUFFO0VBQVUsQ0FBQztFQUMvQ0MsR0FBRyxDQUFDQyxJQUFJLEdBQUdDLElBQUksQ0FBQ0MsRUFBRSxDQUFDLE1BQU0sV0FBVyxDQUFDO0VBRXJDLE1BQU1DLEtBQUssR0FBR2QsV0FBVyxDQUFDTyxPQUFPLENBQUM7RUFFbENRLE1BQU0sQ0FBQ0wsR0FBRyxDQUFDQyxJQUFJLENBQUMsQ0FBQ0ssb0JBQW9CLENBQUNULE9BQU8sRUFBRSxZQUFZLEVBQUU7SUFDM0RVLFNBQVMsRUFBRTtFQUNiLENBQUMsQ0FBQztBQUNKLENBQUMsQ0FBQyJ9