52ce8c69055abf74b48d912007d96225
import jwt from 'jsonwebtoken';
import { promisify } from 'util';
import AppError from '../../middlewares/error/appError.js';
export const createToken = payload => {
  try {
    if (!payload) throw new AppError('Payload is missing at create token function!', 500);
    const jwtToken = jwt.sign(payload, process.env.JWT_SECRET, {
      expiresIn: process.env.JWT_EXPIRES_IN
    });
    return jwtToken;
  } catch (error) {
    throw new AppError(error.message, 500);
  }
};
export const verifyToken = async token => {
  try {
    if (!token) throw new AppError('Token is missing at verify token function!', 500);
    const decodedPayload = await promisify(jwt.verify)(token, process.env.JWT_SECRET);
    return decodedPayload;
  } catch (error) {
    throw new AppError('Invalid Token, Please login!', 500);
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJwcm9taXNpZnkiLCJBcHBFcnJvciIsImNyZWF0ZVRva2VuIiwicGF5bG9hZCIsImp3dFRva2VuIiwic2lnbiIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwiSldUX0VYUElSRVNfSU4iLCJlcnJvciIsIm1lc3NhZ2UiLCJ2ZXJpZnlUb2tlbiIsInRva2VuIiwiZGVjb2RlZFBheWxvYWQiLCJ2ZXJpZnkiXSwic291cmNlcyI6WyJqd3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tICdqc29ud2VidG9rZW4nO1xyXG5pbXBvcnQgeyBwcm9taXNpZnkgfSBmcm9tICd1dGlsJztcclxuaW1wb3J0IEFwcEVycm9yIGZyb20gJy4uLy4uL21pZGRsZXdhcmVzL2Vycm9yL2FwcEVycm9yLmpzJztcclxuXHJcbmV4cG9ydCBjb25zdCBjcmVhdGVUb2tlbiA9IHBheWxvYWQgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBpZiAoIXBheWxvYWQpXHJcbiAgICAgIHRocm93IG5ldyBBcHBFcnJvcignUGF5bG9hZCBpcyBtaXNzaW5nIGF0IGNyZWF0ZSB0b2tlbiBmdW5jdGlvbiEnLCA1MDApO1xyXG5cclxuICAgIGNvbnN0IGp3dFRva2VuID0gand0LnNpZ24ocGF5bG9hZCwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCwge1xyXG4gICAgICBleHBpcmVzSW46IHByb2Nlc3MuZW52LkpXVF9FWFBJUkVTX0lOLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGp3dFRva2VuO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICB0aHJvdyBuZXcgQXBwRXJyb3IoZXJyb3IubWVzc2FnZSwgNTAwKTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdmVyaWZ5VG9rZW4gPSBhc3luYyB0b2tlbiA9PiB7XHJcbiAgdHJ5IHtcclxuICAgIGlmICghdG9rZW4pXHJcbiAgICAgIHRocm93IG5ldyBBcHBFcnJvcignVG9rZW4gaXMgbWlzc2luZyBhdCB2ZXJpZnkgdG9rZW4gZnVuY3Rpb24hJywgNTAwKTtcclxuXHJcbiAgICBjb25zdCBkZWNvZGVkUGF5bG9hZCA9IGF3YWl0IHByb21pc2lmeShqd3QudmVyaWZ5KShcclxuICAgICAgdG9rZW4sXHJcbiAgICAgIHByb2Nlc3MuZW52LkpXVF9TRUNSRVRcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIGRlY29kZWRQYXlsb2FkO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICB0aHJvdyBuZXcgQXBwRXJyb3IoJ0ludmFsaWQgVG9rZW4sIFBsZWFzZSBsb2dpbiEnLCA1MDApO1xyXG4gIH1cclxufTtcclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPQSxHQUFHLE1BQU0sY0FBYztBQUM5QixTQUFTQyxTQUFTLFFBQVEsTUFBTTtBQUNoQyxPQUFPQyxRQUFRLE1BQU0scUNBQXFDO0FBRTFELE9BQU8sTUFBTUMsV0FBVyxHQUFHQyxPQUFPLElBQUk7RUFDcEMsSUFBSTtJQUNGLElBQUksQ0FBQ0EsT0FBTyxFQUNWLE1BQU0sSUFBSUYsUUFBUSxDQUFDLDhDQUE4QyxFQUFFLEdBQUcsQ0FBQztJQUV6RSxNQUFNRyxRQUFRLEdBQUdMLEdBQUcsQ0FBQ00sSUFBSSxDQUFDRixPQUFPLEVBQUVHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEVBQUU7TUFDekRDLFNBQVMsRUFBRUgsT0FBTyxDQUFDQyxHQUFHLENBQUNHO0lBQ3pCLENBQUMsQ0FBQztJQUVGLE9BQU9OLFFBQVE7RUFDakIsQ0FBQyxDQUFDLE9BQU9PLEtBQUssRUFBRTtJQUNkLE1BQU0sSUFBSVYsUUFBUSxDQUFDVSxLQUFLLENBQUNDLE9BQU8sRUFBRSxHQUFHLENBQUM7RUFDeEM7QUFDRixDQUFDO0FBRUQsT0FBTyxNQUFNQyxXQUFXLEdBQUcsTUFBTUMsS0FBSyxJQUFJO0VBQ3hDLElBQUk7SUFDRixJQUFJLENBQUNBLEtBQUssRUFDUixNQUFNLElBQUliLFFBQVEsQ0FBQyw0Q0FBNEMsRUFBRSxHQUFHLENBQUM7SUFFdkUsTUFBTWMsY0FBYyxHQUFHLE1BQU1mLFNBQVMsQ0FBQ0QsR0FBRyxDQUFDaUIsTUFBTSxDQUFDLENBQ2hERixLQUFLLEVBQ0xSLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUNkLENBQUM7SUFFRCxPQUFPTyxjQUFjO0VBQ3ZCLENBQUMsQ0FBQyxPQUFPSixLQUFLLEVBQUU7SUFDZCxNQUFNLElBQUlWLFFBQVEsQ0FBQyw4QkFBOEIsRUFBRSxHQUFHLENBQUM7RUFDekQ7QUFDRixDQUFDIn0=